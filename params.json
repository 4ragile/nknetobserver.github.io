{"name":"Your Friendly North Korean Network Observer","tagline":"Packets don't care about borders","body":"### Introduction\r\n\r\nOn 17 December 2011, Kim Jong-un became the leader of North Korea.  Two days later, on 19 December 2011, I started my first scan of North Korean IP space.  I was curious to see if their new leader would result in change on their Internet.  That was three years ago.  I've been keeping an eye on that network now and again and have port scans for their allocated Internet address space.\r\n\r\nEver been curious about what North Korea's Internet looks like?  People seem to be interested in that country's use of computers on the Internet more these days for some reason...\r\n\r\n#### Back up a second, how does North Korea get Internet, anyway?\r\n\r\nNorth Korea's Internet access is as unique on this planet as many other things about the country are.  The country is said to have a fairly large internal domestic internet disconnected from the rest of the world.  Most citizens with access to computers are only allowed to access this network, not the global computer network the rest of us connect to, which we call the Internet.  But North Korea isn't completely cut off from the world, select people in North Korea, including government officials, visitors, journalists and other select people, have access to the same network the rest of us do.\r\n\r\nSince only a small portion of the country has access to this network, North Korea is unique in the world for having an extremely small presence on the Internet.  All traffic in and out of North Korea from computers inside the country, to computers anywhere else on the globe, goes through a very limited set of connections.  Generally, on a physical level, North Korean access to the Internet has been through a connection on the border with China, or through satellite links, the latter serving mostly as a backup.  For computer networks on the Internet to talk to one another, they use addresses called IP addresses.  IP addresses come in blocks and those blocks come in two flavors: allocated or assigned.  Generally, allocated IP addresses are given to a network directly and are under complete control of that network.  North Korea's direct IP allocation consisted of 1024 IP addresses, which is where most of their Internet-visible network exists today, these are the addresses I scanned.\r\n\r\nThis well known North Korean network range is 175.45.176.0/22, it is allocated directly:\r\n```\r\ninetnum:        175.45.176.0 - 175.45.179.255\r\nnetname:        STAR-KP\r\ndescr:          Ryugyong-dong\r\ndescr:          Potong-gang District\r\ncountry:        KP\r\nstatus:         ALLOCATED PORTABLE\r\nmnt-by:         APNIC-HM\r\nmnt-lower:      MAINT-STAR-KP\r\nmnt-routes:     MAINT-STAR-KP\r\nchanged:        20091221\r\nsource:         APNIC\r\n```\r\n\r\nNorth Korea also has two more blocks that are *assigned* to it, which means that another network has ultimate control over the addresses, but North Korea's network is allowed to use them:\r\n* 210.52.109.0/24 — this block is assigned to North Korea through China Unicom and their original source of IP addresses before they were allocated their first block in their own right:\r\n```\r\ninetnum:        210.52.109.0 - 210.52.109.255\r\nnetname:        KPTC\r\ncountry:        CN\r\ndescr:          Customer of CNC\r\nstatus:         ASSIGNED NON-PORTABLE\r\nchanged:        20040803\r\nmnt-by:         MAINT-CN-ZM28\r\nsource:         APNIC\r\n```\r\n* 77.94.35.0/24 — this block is assigned to North Korea by [SatGate](http://satgate.net/), a Russian Satellite company, and is the only block of known North Korea IPs under the European RIPE Registry as opposed to APNIC, the registry for the Asian Pacific region.  Interestingly, this block of IP addresses lists the persons responsible for them as working out of an office in Salem, Oregon in the USA:\r\n```\r\ninetnum:        77.94.35.0 - 77.94.35.255\r\nnetname:        SATGATE-FILESTREAM\r\ndescr:          Korean network\r\ncountry:        KP\r\nadmin-c:        AVA205-RIPE\r\nadmin-c:        EVE7-RIPE\r\ntech-c:         PPU4-RIPE\r\ntech-c:         ANM47-RIPE\r\nstatus:         ASSIGNED PA\r\nmnt-by:         SATGATE-MNT\r\nsource:         RIPE\r\n```\r\n\r\n<img src=https://raw.github.com/nknetobserver/nknetobserver.github.io/master/images/satgate.jpg align=\"center\" alt=\"SatGate Coverage Map\">\r\n\r\nAs you can see on the coverage map for SatGate, service to North Korea isn't likely coming from their known satellite beams.  Instead, while the IP address allocation is coming through SatGate, the Internet service itself is [likely coming through IntelSat](https://www.northkoreatech.org/2012/04/08/dprk-gets-second-link-to-internet/).  There's a number of IntelSat Satellites which could be providing service.  IntelSat 22 has a good coverage pattern of the area:\r\n\r\n<img src=https://raw.github.com/nknetobserver/nknetobserver.github.io/master/images/intelsat22.png align=\"center\" alt=\"IntelSat 22 Coverage Map\">\r\n\r\nBut a bunch of their other satellites also provide coverage to parts of the Korean Peninsula with varying degrees of strength.\r\n\r\nMost of the data we have, particularly the data gathered by the excellent [Dyn Research](http://research.dyn.com/2013/03/north-korea-suffers-outage/) (neé Renesys) seems to indicate most of the time almost all North Korean traffic routes through China Unicom.  The satellite connection is just a backup.\r\n\r\nAnyway, long story short.  My port scans focus solely on the 1024 IP addresses allocated to North Korea directly.  This also appears to be the addresses the North Korean Internet services are actually using.\r\n\r\n#### Methods\r\n\r\nSo I've been doing some scans for awhile.  Unfortunately not all of them completed, for various reasons.  I've included the ones that got a good section of the IP space, or felt significant for other reasons.  Three of them (March 2012, June 2014 & September 2014) are complete scans of the block.  The rest are partial, unfortunately.  All my scans were generated using the following commands with the well-known [nmap](http://nmap.org/) port scanner:\r\n```\r\nnmap -p1-65535 -sV -O 175.45.176.0/22 -T4 > nk.scan &\r\nnmap -p1-65535 -sV -O 175.45.176.0/22 -T4 -Pn > nkall.scan &\r\n```\r\n\r\nEssentially, I scanned every port on every IP address, asking nmap to do it's best with service detection and OS detection.\r\n\r\n#### Raw Data\r\n\r\nFeel free to browse through the scan logs.  [You can find them here.](https://https://github.com/nknetobserver/nknetobserver.github.io/tree/master/scans/)  Share what you find.\r\n\r\nThere's also a filtered.scan file in each directory which has some basic filtering away of non-essential information.  Feel free to browse through that instead of the raw logs.\r\n\r\n#### Some things\r\n\r\nMeanwhile, I'm going to point out a few things I've noticed.\r\n\r\nOne of the things I was most interested in is trying to determine whether or not the number of hosts increased in North Korea after the power transition from Kim Jong Il to Kim Jong Un.  The answer there is that for the most part, it hasn't increased much in terms of number of hosts, but if you look at the scans, you get the impression they're using it more.\r\n\r\n##### Infrastructure\r\n\r\nYou can also tell a bit about what North Korea's infrastructure looks like and how they run things.  First off, most of North Korea's infrastructure runs on Linux.  It looks like any standard set of infrastructure, BIND servers run the DNS for .kp.  (ns1.kptc.kp, ns2.kptc.kp, ns3.kptc.kp)\r\n\r\nThis probably isn't a huge surprise, since we know North Korea has their own Linux distro, [Red Star OS](https://en.wikipedia.org/wiki/Red_Star_OS), so it's easy to guess they might be fans.  Luckily, Apache tends to report the flavor of Linux being used and so our scans give us a hint of what flavor of Linux they use.  And indeed, starting in scans this year, you see that some of their web servers on the Internet are running RedStar:\r\n```\r\nNmap scan report for naenara.com.kp (175.45.176.67)\r\nPORT    STATE SERVICE VERSION\r\n80/tcp  open  http    Apache httpd 2.2.15 ((RedStar 3.0)  DAV/2 PHP/5.3.3 mod_ssl/2.2.15 OpenSSL/1.0.0-fips)\r\n```\r\n\r\nThe latest scan includes three RedStar machines.  Interestingly, the Red Hat machines they had running in earlier scans disappeared about this time, so it's probably safe to say they deployed Red Star OS to replace their Red Hat machines.\r\n\r\nThey also use CentOS (4 in the latest scan, more than RedStar), a number of machines that don't report the flavor used and one machine which merely reports (Unix).\r\n\r\nNorth Korea generally wants your new software stacks to get of its lawn.  They don't seem to be your average Web 2.X rails chop shop, instead their webservers have active modules or services for JSP, PHP, Perl and Python.  Their choice of server software is similar: Apache for HTTP (web), BIND for DNS and Cisco equipment at the border.  For SMTP (email), they expose a bunch of different services, from Cisco PIX smptd running on their routers, to sendmail on a machine.  Their mailservers tend to expose Cyrus on POP3's port.  Oh, they're also into Icecast for their streaming media servers, though it's unclear whether they're still using the same thing now.  They also have some windows machines running IIS, (up until about 2013 or so) so they've got a more diverse infrastructure environment going on than just Linux machines everywhere.\r\n\r\nFor the most part, their infrastructure hasn't changed a whole bunch over the period I've been scanning them.  Though North Korea does seem to bring up an increasing number of sites running on the various webservers they have on their slice of the Internet.\r\n\r\nTheir router's appear to be configurable remotely, which is one of those things it seems fairly certain that's caught a bunch of eyes:\r\n```\r\nNmap scan report for 175.45.178.129\r\nNot shown: 65523 closed ports\r\nPORT     STATE    SERVICE        VERSION\r\n22/tcp   open     ssh            Cisco SSH 1.25 (protocol 1.99)\r\n23/tcp   open     telnet         Cisco router telnetd\r\n80/tcp   open     http           Cisco IOS http config\r\n443/tcp  open     ssl/http       Cisco IOS http config\r\n```\r\n\r\nSo that's a quick view of some of the visible infrastructure-y parts of their network.  I just grabbed the highlights, leaning towards the more current scans.  There's a bunch of different stuff running, browse through the full scans for more.\r\n\r\n##### Client Machines\r\n\r\nMore interesting is the other stuff that shows up on their network, even for brief periods of time.  It seems that while most stuff in North Korea is kept behind the edge infrastructure, some stuff does show up right on the public Internet space.\r\n\r\n###### Apples apples everywhere, but not a bite to eat\r\n\r\nIn a 20 March 2012 scan, I saw MacBook Air that reported itself as 4,1 model which means it was a \"Late 2008\" model.  It's got a pretty unusual networking footprint, not something you see out of the box:\r\n```\r\nmap scan report for 175.45.177.38\r\nHost is up (0.35s latency).\r\nNot shown: 65521 closed ports\r\nPORT     STATE    SERVICE        VERSION\r\n22/tcp   open     ssh            OpenSSH 5.6 (protocol 2.0)\r\n88/tcp   open     kerberos-sec   Microsoft Windows kerberos-sec\r\n135/tcp  filtered msrpc\r\n136/tcp  filtered profile\r\n137/tcp  filtered netbios-ns\r\n138/tcp  filtered netbios-dgm\r\n139/tcp  filtered netbios-ssn\r\n445/tcp  filtered microsoft-ds\r\n548/tcp  open     afp?\r\n593/tcp  filtered http-rpc-epmap\r\n3689/tcp open     rendezvous?\r\n4444/tcp filtered krb524\r\n4488/tcp open     unknown\r\n5900/tcp open     vnc            Apple remote desktop vnc\r\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at http://www.insecure.org/cg\r\ni-bin/servicefp-submit.cgi :\r\nSF-Port548-TCP:V=5.50%I=7%D=3/20%Time=4F687DAA%P=x86_64-redhat-linux-gnu%r\r\nSF:(SSLSessionReq,223,\"\\x01\\x03\\0\\0Q\\xec\\xff\\xff\\0\\0\\x02\\x13\\0\\0\\0\\0\\x000\\\r\nSF:0>\\0b\\0\\0\\x9f\\xfb\\x1badministrator\\xd5s\\x20MacBook\\x20Air\\0\\x9b\\0\\xab\\0\r\nSF:\\xff\\x01p\\x01\\x8f\\rMacBookAir4,1\\x05\\x06AFP3\\.4\\x06AFP3\\.3\\x06AFP3\\.2\\x\r\nSF:06AFP3\\.1\\x06AFPX03\\x06\\tDHCAST128\\x04DHX2\\x06Recon1\\rClient\\x20Krb\\x20\r\nSF:v2\\x03GSS\\x0fNo\\x20User\\x20Authent\\x15\\+\\xc3\\xd9\\xf9Q\\[\\xc7\\xa1\\x02\\xa7\r\nSF:D\\x88D\\xb2\\(\\x05\\x08\\x02\\xaf-\\xb1&\\x02\\$\\x14\\x07\\xfe\\x80\\0\\0\\0\\0\\0\\0\\x0\r\nSF:2\\0\\0\\xff\\xfe\\0\\r\\x06\\x02\\$\\x14\\x07\\xfe\\x80\\0\\0\\0\\0\\0\\0b\\xc5G\\xff\\xfe\\x\r\nSF:03\\[f\\x02\\$\\x14\\x07\\xfd\\0e\\x87R\\xd7!\\xa4b\\xc5G\\xff\\xfe\\x03\\[f\\x02\\$\\x0f\r\nSF:\\x04175\\.45\\.177\\.38\\x01oafpserver/LKDC:SHA1\\.AA6C3E197C870B839764D57E8\r\nSF:9AF4A940C95B060@LKDC:SHA1\\.AA6C3E197C870B839764D57E89AF4A940C95B060\\0\\x\r\nSF:1dadministrator\\xe2\\x80\\x99s\\x20MacBook\\x20Air\\0\\0\\0\\x80`~\\x06\\x06\\+\\x0\r\n```\r\n\r\nMy guess is this means the MacBook was running [RECON Suite](http://resources.jamfsoftware.com/archive/Recon_Suite_Administrators_Guide.pdf) which is apparently some sort of enterprise system management software.  I'm not too familiar with it.\r\n\r\nBottom line: there are MacBooks in North Korea.  This one might be some journalist's machine, which seems like a more likely explanation.\r\n\r\n###### Virtualization\r\n\r\nLest you think that North Korea is completely backwards and can't get keep up with new technologies, let's set something straight right now. They've got VMware:\r\n```\r\nNmap scan report for 175.45.178.134\r\nNot shown: 65534 filtered ports\r\nPORT    STATE SERVICE     VERSION\r\n912/tcp open  vmware-auth VMware Authentication Daemon 1.0 (Uses VNC, SOAP)\r\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\r\nDevice type: general purpose|phone\r\nRunning: Microsoft Windows 2008|Phone|Vista|7\r\nOS CPE: cpe:/o:microsoft:windows_server_2008::beta3 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows_7\r\nOS details: Microsoft Windows Server 2008 Beta 3, Microsoft Windows Phone 7.5, Microsoft Windows Vista SP0 or SP1, Windows Server 2008 SP1, or Windows 7, Microsoft Windows Vista SP2, Windows 7 SP1, or Windows Server 2008\r\n```\r\n\r\nNow that right there is probably a windows machine running in a VM.  I didn't see evidence of these on the network until September 2014 or so.  Which means deploying exposing virtual machines on the public Internet is a newer thing for them, but they've probably been playing with it inside their internal network for a long time now.\r\n\r\n#### Farewell!\r\n\r\nEnjoy the scans, have fun, let folks know if you see anything interesting.\r\n\r\n\r\n#### Credits, Sources, etc.\r\n\r\nYour friendly North Korean network observer: nknetobserver\r\nExcellent routing analysis: Renesys (now Dyn Research)\r\nOther analysis of North Korea's network space: [HP Security Research](http://h30499.www3.hp.com/hpeb/attachments/hpeb/off-by-on-software-security-blog/388/2/HPSR%20SecurityBriefing_Episode16_NorthKorea.pdf)\r\nSatGate coverage map: http://satgate.net/images/new_maps/map_index.jpg\r\nIntelSat coverage maps: http://exnetapps.intelsat.com/flash/coverage-maps/index.html","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}